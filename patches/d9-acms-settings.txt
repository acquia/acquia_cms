
/**
 * Load local development override configuration, if available.
 *
 * Create a settings.local.php file to override variables on secondary (staging,
 * development, etc.) installations of this site.
 *
 * Typical uses of settings.local.php include:
 * - Disabling caching.
 * - Disabling JavaScript/CSS compression.
 * - Rerouting outgoing emails.
 *
 * Keep this code block at the end of this file to take full effect.
 */
#
# if (file_exists($app_root . '/' . $site_path . '/settings.local.php')) {
#   include $app_root . '/' . $site_path . '/settings.local.php';
# }

/**
 * Auto-connect to the correct Acquia credentials file.
 */
use Acquia\DrupalEnvironmentDetector\AcquiaDrupalEnvironmentDetector;

/**
 * Site path.
 *
 * @var $site_path
 * This is always set and exposed by the Drupal Kernel.
 */
// phpcs:ignore
$site_name = AcquiaDrupalEnvironmentDetector::getSiteName($site_path);
// Acquia Cloud settings.
if (AcquiaDrupalEnvironmentDetector::isAhEnv()) {
  $ah_group = AcquiaDrupalEnvironmentDetector::getAhGroup();
  if (!AcquiaDrupalEnvironmentDetector::isAcsfEnv()) {
    if ($site_name == 'default') {
      require "/var/www/site-php/$ah_group/$ah_group-settings.inc";
    } else {
      // Acquia Cloud does not support periods in db names.
      $safe_site_name = str_replace('.', '_', $site_name);
      require "/var/www/site-php/$ah_group/$safe_site_name-settings.inc";
    }
  }

  /**
   * ACMS will only load memcache if the user explicitly asks us to.
   * acquia/memcache-settings will only configure the cache bins if
   * servers are present in $settings['memcache'], which are set in
   * the Acquia common settings files above. This lets us disable
   * memcache without a code deploy. This logic should make its way
   * to acquia/memcache-settings eventually.
   */
  if (!getenv('ENABLE_MEMCACHED')) {
    unset($settings['memcache']);
  }
}
